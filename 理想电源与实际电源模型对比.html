<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>理想电源与实际电源模型对比</title>
    <style>
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            color: #495057;
        }
        
        .container {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            padding: 30px;
            max-width: 1300px;
            width: 100%;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-weight: bold;
            font-size: 2.4rem;
            letter-spacing: -0.5px;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            background: rgba(255, 255, 255, 0.7);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(255, 255, 255, 0.8);
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .control-group label {
            font-size: 16px;
            color: #495057;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .control-group input[type="range"] {
            width: 180px;
            height: 6px;
            margin: 10px 0;
            -webkit-appearance: none;
            background: #e9ecef;
            border-radius: 5px;
            outline: none;
        }
        
        .control-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ff6b6b;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .control-group span {
            font-weight: bold;
            color: #2c3e50;
            font-size: 18px;
        }
        
        .animation-area {
            display: flex;
            gap: 40px;
            justify-content: space-around;
            flex-wrap: wrap;
            background: rgba(255, 255, 255, 0.6);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.03);
        }
        
        .canvas-container {
            position: relative;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            background: #ffffff;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            overflow: hidden;
        }
        
        canvas {
            display: block;
        }
        
        .info-panel {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            padding: 25px;
            margin-top: 25px;
            border-left: 4px solid #ff6b6b;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        
        .info-panel h3 {
            margin-top: 0;
            color: #2c3e50;
            font-weight: bold;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-panel p {
            color: #495057;
            line-height: 1.8;
            margin: 15px 0;
            font-size: 18px;
            font-weight: 500;
        }
        
        .info-panel ul {
            margin: 20px 0;
            padding-left: 25px;
        }
        
        .info-panel li {
            margin: 12px 0;
            color: #495057;
            font-size: 18px;
            font-weight: 500;
        }
        
        .legend {
            display: flex;
            gap: 40px;
            justify-content: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            background: rgba(255, 255, 255, 0.7);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: bold;
            color: #495057;
        }
        
        .legend-item span {
            font-size: 18px;
            font-weight: bold;
        }
        
        .color-box {
            width: 30px;
            height: 6px;
            border-radius: 3px;
        }
        
        .formula-box {
            font-size: 22px;
            font-weight: bold;
            color: #c0392b;
            background: rgba(231, 76, 60, 0.1);
            padding: 10px 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            display: inline-block;
            margin: 5px 0;
            border-left: 4px solid #e74c3c;
        }
        
        .key-term {
            font-weight: bold;
            color: #2980b9;
            font-size: 20px;
            background: rgba(52, 152, 219, 0.1);
            padding: 4px 8px;
            border-radius: 6px;
        }
        
        .comparison-table {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 25px;
        }
        
        .table-title {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            grid-column: 1 / -1;
        }
        
        .circuit-title {
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .data-display {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .data-item {
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            text-align: center;
        }
        
        .data-label {
            font-weight: bold;
            color: #6c757d;
            font-size: 16px;
            margin-bottom: 8px;
        }
        
        .data-value {
            font-weight: bold;
            font-size: 24px;
            color: #2c3e50;
        }
        
        .ideal-data .data-value {
            color: #27ae60;
        }
        
        .real-data .data-value {
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>理想电源与实际电源模型对比演示</h1>
        
        <div class="controls">
            <div class="control-group">
                <label>负载电阻 (R_load)</label>
                <input type="range" id="load-resistance" min="1" max="20" step="0.5" value="5">
                <span id="load-value">5.0 Ω</span>
            </div>
            <div class="control-group">
                <label>电源内阻 (R_internal)</label>
                <input type="range" id="internal-resistance" min="0" max="5" step="0.2" value="1">
                <span id="internal-value">1.0 Ω</span>
            </div>
            <div class="control-group">
                <label>电源电动势 (E)</label>
                <input type="range" id="emf" min="6" max="12" step="0.5" value="9">
                <span id="emf-value">9.0 V</span>
            </div>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="color-box" style="background: #27ae60;"></div>
                <span>理想电源输出</span>
            </div>
            <div class="legend-item">
                <div class="color-box" style="background: #e74c3c;"></div>
                <span>实际电源输出</span>
            </div>
            <div class="legend-item">
                <div class="color-box" style="background: #3498db;"></div>
                <span>电流方向</span>
            </div>
            <div class="legend-item">
                <div class="color-box" style="background: #f39c12;"></div>
                <span>电压降分布</span>
            </div>
        </div>
        
        <div class="comparison-table">
            <div class="table-title">电路对比与实时数据</div>
            <div>
                <div class="circuit-title" style="color: #27ae60;">理想电压源模型</div>
                <div class="canvas-container">
                    <canvas id="idealCircuitCanvas" width="450" height="350"></canvas>
                </div>
            </div>
            <div>
                <div class="circuit-title" style="color: #e74c3c;">实际电压源模型（含内阻）</div>
                <div class="canvas-container">
                    <canvas id="realCircuitCanvas" width="450" height="350"></canvas>
                </div>
            </div>
        </div>
        
        <div class="data-display">
            <div class="data-item ideal-data">
                <div class="data-label">理想电源输出电压</div>
                <div class="data-value" id="ideal-voltage">9.00 V</div>
            </div>
            <div class="data-item real-data">
                <div class="data-label">实际电源输出电压</div>
                <div class="data-value" id="real-voltage">7.50 V</div>
            </div>
            <div class="data-item ideal-data">
                <div class="data-label">理想电源输出电流</div>
                <div class="data-value" id="ideal-current">1.80 A</div>
            </div>
            <div class="data-item real-data">
                <div class="data-label">实际电源输出电流</div>
                <div class="data-value" id="real-current">1.50 A</div>
            </div>
        </div>
        
        <div class="canvas-container" style="margin-top: 25px;">
            <div class="circuit-title" style="text-align: center; margin-bottom: 15px;">输出特性曲线对比（负载变化时）</div>
            <canvas id="characteristicCanvas" width="900" height="350"></canvas>
        </div>
        
        <div class="info-panel">
            <h3>核心原理与公式</h3>
            <p><strong class="key-term">理想电压源：</strong>输出电压恒定不变，内阻为零。负载变化时输出电压始终等于电动势。</p>
            <p><strong class="key-term">实际电压源：</strong>存在内阻分压效应，输出电压随负载电流增大而下降。</p>
            <p><strong class="key-term">输出电压计算：</strong></p>
            <ul style="list-style: none;">
                <li>• 理想电源：<span class="formula-box">V_out = E</span></li>
                <li>• 实际电源：<span class="formula-box">V_out = E * R_load / (R_load + R_internal)</span></li>
            </ul>
            <p><strong class="key-term">教学要点：</strong>电源内阻越小越好，当 R_internal 远小于 R_load 时，实际电源可近似为理想电源。</p>
        </div>
        
        <div class="info-panel">
            <h3>操作说明与观察重点</h3>
            <ul>
                <li>调节<strong class="key-term">负载电阻</strong>观察两个电路的输出电压变化差异</li>
                <li>调节<strong class="key-term">电源内阻</strong>观察内阻对输出特性的影响程度</li>
                <li>观察<strong class="key-term">输出特性曲线</strong>：理想电源为水平线，实际电源为下降曲线</li>
                <li>注意电流增大时，内阻上的电压降（IR降）增大，导致输出电压下降</li>
                <li>比较两种模型的输出电压和电流数值差异</li>
            </ul>
        </div>
    </div>

    <script>
        // 获取画布和上下文
        const idealCanvas = document.getElementById('idealCircuitCanvas');
        const idealCtx = idealCanvas.getContext('2d');
        const realCanvas = document.getElementById('realCircuitCanvas');
        const realCtx = realCanvas.getContext('2d');
        const characteristicCanvas = document.getElementById('characteristicCanvas');
        const characteristicCtx = characteristicCanvas.getContext('2d');
        
        // 控制元素
        const loadSlider = document.getElementById('load-resistance');
        const internalSlider = document.getElementById('internal-resistance');
        const emfSlider = document.getElementById('emf');
        const loadValue = document.getElementById('load-value');
        const internalValue = document.getElementById('internal-value');
        const emfValue = document.getElementById('emf-value');
        const idealVoltageDisplay = document.getElementById('ideal-voltage');
        const realVoltageDisplay = document.getElementById('real-voltage');
        const idealCurrentDisplay = document.getElementById('ideal-current');
        const realCurrentDisplay = document.getElementById('real-current');
        
        // 电路参数
        let R_load = 5.0;
        let R_internal = 1.0;
        let E = 9.0;
        
        // 监听滑块变化
        loadSlider.addEventListener('input', (e) => {
            R_load = parseFloat(e.target.value);
            loadValue.textContent = R_load.toFixed(1) + ' Ω';
            updateCircuit();
        });
        
        internalSlider.addEventListener('input', (e) => {
            R_internal = parseFloat(e.target.value);
            internalValue.textContent = R_internal.toFixed(1) + ' Ω';
            updateCircuit();
        });
        
        emfSlider.addEventListener('input', (e) => {
            E = parseFloat(e.target.value);
            emfValue.textContent = E.toFixed(1) + ' V';
            updateCircuit();
        });
        
        // 计算电路参数
        function calculateCircuit() {
            const idealCurrent = E / R_load;
            const realCurrent = E / (R_load + R_internal);
            const idealVoltage = E;
            const realVoltage = E * (R_load / (R_load + R_internal));
            const internalVoltageDrop = realCurrent * R_internal;
            
            return {
                idealCurrent,
                realCurrent,
                idealVoltage,
                realVoltage,
                internalVoltageDrop
            };
        }
        
        // 绘制理想电路
        function drawIdealCircuit() {
            idealCtx.clearRect(0, 0, idealCanvas.width, idealCanvas.height);
            const centerX = idealCanvas.width / 2;
            const centerY = idealCanvas.height / 2;
            const results = calculateCircuit();
            
            // 绘制电池（理想电源）
            idealCtx.strokeStyle = '#27ae60';
            idealCtx.lineWidth = 4;
            idealCtx.beginPath();
            idealCtx.moveTo(50, centerY);
            idealCtx.lineTo(80, centerY);
            idealCtx.moveTo(70, centerY - 25);
            idealCtx.lineTo(70, centerY + 25);
            idealCtx.moveTo(75, centerY - 18);
            idealCtx.lineTo(75, centerY + 18);
            idealCtx.stroke();
            
            // 理想电源标识
            idealCtx.font = 'bold 18px Microsoft YaHei';
            idealCtx.fillStyle = '#27ae60';
            idealCtx.fillText('理想电源', 10, 35);
            
            // 绘制负载电阻
            idealCtx.strokeStyle = '#2c3e50';
            idealCtx.lineWidth = 4;
            idealCtx.beginPath();
            idealCtx.moveTo(150, centerY - 35);
            idealCtx.lineTo(150, centerY + 35);
            idealCtx.lineTo(160, centerY + 20);
            idealCtx.lineTo(160, centerY - 20);
            idealCtx.lineTo(170, centerY + 20);
            idealCtx.lineTo(170, centerY - 20);
            idealCtx.lineTo(180, centerY + 35);
            idealCtx.lineTo(180, centerY - 35);
            idealCtx.stroke();
            
            // 连接导线
            idealCtx.strokeStyle = '#2c3e50';
            idealCtx.lineWidth = 4;
            idealCtx.beginPath();
            idealCtx.moveTo(80, centerY);
            idealCtx.lineTo(150, centerY);
            idealCtx.moveTo(180, centerY);
            idealCtx.lineTo(250, centerY);
            idealCtx.lineTo(250, centerY + 60);
            idealCtx.lineTo(50, centerY + 60);
            idealCtx.lineTo(50, centerY);
            idealCtx.stroke();
            
            // 电流箭头
            if (results.idealCurrent > 0.15) {
                idealCtx.fillStyle = '#3498db';
                idealCtx.beginPath();
                idealCtx.moveTo(120, centerY - 15);
                idealCtx.lineTo(135, centerY - 15);
                idealCtx.lineTo(128, centerY - 22);
                idealCtx.lineTo(142, centerY - 15);
                idealCtx.lineTo(128, centerY - 8);
                idealCtx.closePath();
                idealCtx.fill();
            }
            
            // 显示数值
            idealCtx.font = 'bold 20px Microsoft YaHei';
            idealCtx.fillStyle = '#2c3e50';
            idealCtx.fillText(`V_out = ${results.idealVoltage.toFixed(2)} V`, 20, 100);
            idealCtx.fillText(`I = ${results.idealCurrent.toFixed(2)} A`, 20, 140);
            
            // 负载标注
            idealCtx.font = 'bold 16px Microsoft YaHei';
            idealCtx.fillStyle = '#2c3e50';
            idealCtx.fillText('R_load', 155, centerY - 45);
        }
        
        // 绘制实际电路
        function drawRealCircuit() {
            realCtx.clearRect(0, 0, realCanvas.width, realCanvas.height);
            const centerX = realCanvas.width / 2;
            const centerY = realCanvas.height / 2;
            const results = calculateCircuit();
            
            // 绘制电池（实际电源）
            realCtx.strokeStyle = '#e74c3c';
            realCtx.lineWidth = 4;
            realCtx.beginPath();
            realCtx.moveTo(50, centerY);
            realCtx.lineTo(80, centerY);
            realCtx.moveTo(70, centerY - 25);
            realCtx.lineTo(70, centerY + 25);
            realCtx.moveTo(75, centerY - 18);
            realCtx.lineTo(75, centerY + 18);
            realCtx.stroke();
            
            // 实际电源标识
            realCtx.font = 'bold 18px Microsoft YaHei';
            realCtx.fillStyle = '#e74c3c';
            realCtx.fillText('实际电源', 10, 35);
            
            // 绘制内阻
            realCtx.strokeStyle = '#f39c12';
            realCtx.lineWidth = 4;
            realCtx.beginPath();
            realCtx.moveTo(150, centerY - 30);
            realCtx.lineTo(150, centerY + 30);
            realCtx.lineTo(160, centerY + 15);
            realCtx.lineTo(160, centerY - 15);
            realCtx.lineTo(170, centerY + 15);
            realCtx.lineTo(170, centerY - 15);
            realCtx.lineTo(180, centerY + 30);
            realCtx.lineTo(180, centerY - 30);
            realCtx.stroke();
            
            // 绘制负载电阻
            realCtx.strokeStyle = '#2c3e50';
            realCtx.lineWidth = 4;
            realCtx.beginPath();
            realCtx.moveTo(280, centerY - 30);
            realCtx.lineTo(280, centerY + 30);
            realCtx.lineTo(290, centerY + 15);
            realCtx.lineTo(290, centerY - 15);
            realCtx.lineTo(300, centerY + 15);
            realCtx.lineTo(300, centerY - 15);
            realCtx.lineTo(310, centerY + 30);
            realCtx.lineTo(310, centerY - 30);
            realCtx.stroke();
            
            // 连接导线
            realCtx.strokeStyle = '#2c3e50';
            realCtx.lineWidth = 4;
            realCtx.beginPath();
            realCtx.moveTo(80, centerY);
            realCtx.lineTo(150, centerY);
            realCtx.moveTo(180, centerY);
            realCtx.lineTo(250, centerY);
            realCtx.moveTo(250, centerY);
            realCtx.lineTo(250, centerY + 70);
            realCtx.moveTo(250, centerY + 70);
            realCtx.lineTo(50, centerY + 70);
            realCtx.moveTo(50, centerY + 70);
            realCtx.lineTo(50, centerY);
            
            // 连接负载
            realCtx.moveTo(250, centerY);
            realCtx.lineTo(280, centerY);
            realCtx.moveTo(310, centerY);
            realCtx.lineTo(350, centerY);
            realCtx.lineTo(350, centerY + 70);
            realCtx.lineTo(50, centerY + 70);
            realCtx.stroke();
            
            // 电流箭头
            if (results.realCurrent > 0.15) {
                realCtx.fillStyle = '#3498db';
                realCtx.beginPath();
                realCtx.moveTo(120, centerY - 15);
                realCtx.lineTo(135, centerY - 15);
                realCtx.lineTo(128, centerY - 22);
                realCtx.lineTo(142, centerY - 15);
                realCtx.lineTo(128, centerY - 8);
                realCtx.closePath();
                realCtx.fill();
                
                realCtx.beginPath();
                realCtx.moveTo(265, centerY - 15);
                realCtx.lineTo(280, centerY - 15);
                realCtx.lineTo(273, centerY - 22);
                realCtx.lineTo(287, centerY - 15);
                realCtx.lineTo(273, centerY - 8);
                realCtx.closePath();
                realCtx.fill();
            }
            
            // 标注
            realCtx.font = 'bold 16px Microsoft YaHei';
            realCtx.fillStyle = '#f39c12';
            realCtx.fillText('R_internal', 155, centerY - 40);
            realCtx.fillStyle = '#2c3e50';
            realCtx.fillText('R_load', 285, centerY - 40);
            
            // 显示数值
            realCtx.font = 'bold 20px Microsoft YaHei';
            realCtx.fillStyle = '#2c3e50';
            realCtx.fillText(`V_out = ${results.realVoltage.toFixed(2)} V`, 20, 100);
            realCtx.fillText(`I = ${results.realCurrent.toFixed(2)} A`, 20, 140);
            realCtx.fillText(`V_int = ${results.internalVoltageDrop.toFixed(2)} V`, 20, 180);
        }
        
        // 绘制特性曲线
        function drawCharacteristicCurve() {
            characteristicCtx.clearRect(0, 0, characteristicCanvas.width, characteristicCanvas.height);
            const padding = 80;
            const width = characteristicCanvas.width - 2 * padding;
            const height = characteristicCanvas.height - 2 * padding;
            
            // 坐标轴
            characteristicCtx.strokeStyle = '#2c3e50';
            characteristicCtx.lineWidth = 4;
            characteristicCtx.beginPath();
            characteristicCtx.moveTo(padding, padding);
            characteristicCtx.lineTo(padding, characteristicCanvas.height - padding);
            characteristicCtx.lineTo(characteristicCanvas.width - padding, characteristicCanvas.height - padding);
            characteristicCtx.stroke();
            
            // 网格
            characteristicCtx.strokeStyle = '#e9ecef';
            characteristicCtx.lineWidth = 1;
            for (let i = 1; i <= 5; i++) {
                const x = padding + (i * width / 5);
                const y = padding + (i * height / 5);
                characteristicCtx.beginPath();
                characteristicCtx.moveTo(x, padding);
                characteristicCtx.lineTo(x, characteristicCanvas.height - padding);
                characteristicCtx.moveTo(padding, y);
                characteristicCtx.lineTo(characteristicCanvas.width - padding, y);
                characteristicCtx.stroke();
            }
            
            // 标签
            characteristicCtx.font = 'bold 18px Microsoft YaHei';
            characteristicCtx.fillStyle = '#2c3e50';
            characteristicCtx.fillText('负载电阻 R_load (Ω)', characteristicCanvas.width - 220, characteristicCanvas.height - 20);
            characteristicCtx.save();
            characteristicCtx.translate(40, characteristicCanvas.height / 2);
            characteristicCtx.rotate(-Math.PI / 2);
            characteristicCtx.fillText('输出电压 V_out (V)', -50, 0);
            characteristicCtx.restore();
            
            // 当前负载位置
            const currentX = padding + (R_load / 20) * width;
            characteristicCtx.strokeStyle = '#95a5a6';
            characteristicCtx.lineWidth = 1;
            characteristicCtx.setLineDash([5, 5]);
            characteristicCtx.beginPath();
            characteristicCtx.moveTo(currentX, padding);
            characteristicCtx.lineTo(currentX, characteristicCanvas.height - padding);
            characteristicCtx.stroke();
            characteristicCtx.setLineDash([]);
            
            // 理想电源曲线（水平线）
            characteristicCtx.strokeStyle = '#27ae60';
            characteristicCtx.lineWidth = 4;
            characteristicCtx.beginPath();
            characteristicCtx.moveTo(padding, characteristicCanvas.height - padding - (E / 12) * height);
            characteristicCtx.lineTo(characteristicCanvas.width - padding, characteristicCanvas.height - padding - (E / 12) * height);
            characteristicCtx.stroke();
            
            // 实际电源曲线
            characteristicCtx.strokeStyle = '#e74c3c';
            characteristicCtx.lineWidth = 4;
            characteristicCtx.beginPath();
            for (let r = 1; r <= 20; r += 0.5) {
                const v = E * (r / (r + R_internal));
                const x = padding + (r / 20) * width;
                const y = characteristicCanvas.height - padding - (v / 12) * height;
                if (r === 1) {
                    characteristicCtx.moveTo(x, y);
                } else {
                    characteristicCtx.lineTo(x, y);
                }
            }
            characteristicCtx.stroke();
            
            // 当前工作点
            const results = calculateCircuit();
            const currentPointX = padding + (R_load / 20) * width;
            const currentPointY = characteristicCanvas.height - padding - (results.realVoltage / 12) * height;
            
            characteristicCtx.fillStyle = '#e74c3c';
            characteristicCtx.beginPath();
            characteristicCtx.arc(currentPointX, currentPointY, 10, 0, 2 * Math.PI);
            characteristicCtx.fill();
            
            // 图例
            characteristicCtx.font = 'bold 18px Microsoft YaHei';
            characteristicCtx.fillStyle = '#27ae60';
            characteristicCtx.fillRect(characteristicCanvas.width - 280, 30, 25, 6);
            characteristicCtx.fillText('理想电源: V_out = E', characteristicCanvas.width - 250, 38);
            
            characteristicCtx.fillStyle = '#e74c3c';
            characteristicCtx.fillRect(characteristicCanvas.width - 280, 55, 25, 6);
            characteristicCtx.fillText('实际电源: V_out = E * R_load / (R_load + R_internal)', characteristicCanvas.width - 250, 63);
            
            // 当前值标注
            characteristicCtx.fillStyle = '#2c3e50';
            characteristicCtx.fillText(`当前: R_load = ${R_load.toFixed(1)}Ω, V_out = ${results.realVoltage.toFixed(2)}V`, padding + 20, padding + 30);
        }
        
        // 更新数据显示
        function updateDataDisplay() {
            const results = calculateCircuit();
            idealVoltageDisplay.textContent = results.idealVoltage.toFixed(2) + ' V';
            realVoltageDisplay.textContent = results.realVoltage.toFixed(2) + ' V';
            idealCurrentDisplay.textContent = results.idealCurrent.toFixed(2) + ' A';
            realCurrentDisplay.textContent = results.realCurrent.toFixed(2) + ' A';
        }
        
        // 更新所有图形
        function updateCircuit() {
            drawIdealCircuit();
            drawRealCircuit();
            drawCharacteristicCurve();
            updateDataDisplay();
        }
        
        // 初始化
        updateCircuit();
    </script>
</body>
</html>