<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”µè·¯æ—¶åŸŸåˆ†ææ³•ä¸ç›¸é‡æ³•åŠ¨ç”»æ¼”ç¤º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            min-height: 100vh;
            padding: 20px;
            color: #1e293b;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(2, 132, 199, 0.15);
            border: 2px solid #cbd5e1;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #0284c7, #0ea5e9);
            color: white;
            padding: 40px 30px;
            text-align: center;
            border-bottom: 3px solid #0369a1;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 15px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            letter-spacing: 0.5px;
            font-weight: 800;
        }

        .header p {
            font-size: 1.4em;
            opacity: 0.95;
            max-width: 800px;
            margin: 0 auto;
            font-weight: 600;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        .section {
            background: #f1f5f9;
            border-radius: 12px;
            padding: 25px;
            border: 2px solid #cbd5e1;
            box-shadow: 0 4px 12px rgba(2, 132, 199, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .section:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(2, 132, 199, 0.2);
        }

        .section-title {
            font-size: 2.2em;
            color: #0369a1;
            margin-bottom: 25px;
            text-align: center;
            padding-bottom: 12px;
            border-bottom: 3px solid #0284c7;
            font-weight: 800;
        }

        .animation-container {
            background: #ffffff;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            min-height: 320px;
            border: 2px solid #e2e8f0;
            position: relative;
        }

        canvas {
            border: 2px solid #94a3b8;
            border-radius: 6px;
            display: block;
            margin: 0 auto;
            background: #ffffff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            max-width: 100%;
            height: auto;
        }

        .formula {
            background: #e0f2fe;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            text-align: center;
            border: 2px solid #0284c7;
            color: #1e40af;
            font-size: 1.3em;
            font-weight: 700;
            box-shadow: inset 0 0 8px rgba(2, 132, 199, 0.1);
        }

        .features {
            list-style: none;
            margin: 20px 0;
        }

        .features li {
            padding: 15px;
            margin: 10px 0;
            background: #e2e8f0;
            border-radius: 8px;
            border-left: 5px solid #0284c7;
            font-size: 1.1em;
            font-weight: 600;
            color: #1e293b;
            line-height: 1.5;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin: 25px 0;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat-item {
            text-align: center;
            padding: 20px 15px;
            background: #e0f2fe;
            border-radius: 10px;
            min-width: 140px;
            border: 2px solid #0284c7;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }

        .stat-value {
            font-size: 2.2em;
            font-weight: 800;
            color: #1e40af;
            display: block;
        }

        .stat-label {
            font-size: 1em;
            color: #475569;
            margin-top: 8px;
            font-weight: 600;
        }

        .comparison {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #dbeafe, #e0f2fe);
            padding: 40px 30px;
            border-radius: 15px;
            margin-top: 30px;
            border: 2px solid #0284c7;
        }

        .comparison h2 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.4em;
            color: #1e40af;
            font-weight: 800;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
            margin-top: 25px;
        }

        .comparison-item {
            background: #ffffff;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #cbd5e1;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .control-panel {
            background: #f1f5f9;
            padding: 30px;
            border-radius: 12px;
            margin: 30px 0;
            text-align: center;
            border: 2px solid #cbd5e1;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 25px;
        }

        button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 700;
            min-width: 120px;
        }

        .btn-primary { background: linear-gradient(135deg, #0284c7, #0ea5e9); color: white; }
        .btn-secondary { background: linear-gradient(135deg, #7c3aed, #8b5cf6); color: white; }
        .btn-danger { background: linear-gradient(135deg, #dc2626, #ef4444); color: white; }

        .tooltip {
            position: fixed;
            background: #ffffff;
            color: #1e293b;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 1em;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
            border: 2px solid #0284c7;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            font-weight: 600;
            max-width: 250px;
            line-height: 1.5;
        }

        .tooltip.show { opacity: 1; }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                padding: 20px;
            }
            
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            canvas {
                max-width: 100%;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”Œ ç”µè·¯æ—¶åŸŸåˆ†ææ³• vs ç›¸é‡æ³•</h1>
            <p>æ·±å…¥ç†è§£ä¸¤ç§ç”µè·¯åˆ†ææ–¹æ³•çš„åŸç†ã€å…³ç³»ä¸åŒºåˆ«</p>
        </div>

        <div class="main-content">
            <!-- æ—¶åŸŸåˆ†æéƒ¨åˆ† -->
            <div class="section">
                <h2 class="section-title">â±ï¸ æ—¶åŸŸåˆ†ææ³•</h2>
                
                <div class="animation-container">
                    <canvas id="timeDomainCanvas" width="400" height="250"></canvas>
                </div>

                <div class="formula">
                    <strong>æ­£å¼¦ç”µå‹è¡¨è¾¾å¼ï¼š</strong><br>
                    u(t) = Uâ‚˜ sin(Ï‰t + Ï†)
                </div>

                <div class="formula">
                    <strong>å¾®åˆ†æ–¹ç¨‹ï¼š</strong><br>
                    L(di/dt) + Ri + (1/C)âˆ«i dt = u(t)
                </div>

                <ul class="features">
                    <li><strong>ç‰¹ç‚¹ï¼š</strong>ç›´æ¥åœ¨æ—¶é—´åŸŸåˆ†æç”µè·¯</li>
                    <li><strong>ä¼˜ç‚¹ï¼š</strong>ç›´è§‚ã€ç‰©ç†æ„ä¹‰æ˜ç¡®</li>
                    <li><strong>ç¼ºç‚¹ï¼š</strong>å¾®åˆ†æ–¹ç¨‹æ±‚è§£å¤æ‚</li>
                    <li><strong>é€‚ç”¨ï¼š</strong>ç¬æ€åˆ†æã€éçº¿æ€§ç”µè·¯</li>
                </ul>

                <div class="stats">
                    <div class="stat-item">
                        <span class="stat-value" id="timeFreq">50</span>
                        <div class="stat-label">é¢‘ç‡ (Hz)</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="timeAmp">1.0</span>
                        <div class="stat-label">å¹…å€¼ (V)</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="timePhase">0</span>
                        <div class="stat-label">ç›¸ä½ (Â°)</div>
                    </div>
                </div>
            </div>

            <!-- ç›¸é‡æ³•éƒ¨åˆ† -->
            <div class="section">
                <h2 class="section-title">ğŸ¯ ç›¸é‡æ³•</h2>
                
                <div class="animation-container">
                    <canvas id="phasorCanvas" width="400" height="250"></canvas>
                </div>

                <div class="formula">
                    <strong>ç›¸é‡è¡¨ç¤ºï¼š</strong><br>
                    áº = Uâ‚˜âˆ Ï† = Uâ‚˜e^(jÏ†)
                </div>

                <div class="formula">
                    <strong>æ¬§å§†å®šå¾‹ï¼ˆç›¸é‡å½¢å¼ï¼‰ï¼š</strong><br>
                    áº = ZÄ°
                </div>

                <ul class="features">
                    <li><strong>ç‰¹ç‚¹ï¼š</strong>å°†æ­£å¼¦é‡è½¬æ¢ä¸ºå¤æ•°</li>
                    <li><strong>ä¼˜ç‚¹ï¼š</strong>ç®€åŒ–è®¡ç®—ï¼Œä»£æ•°è¿ç®—</li>
                    <li><strong>ç¼ºç‚¹ï¼š</strong>ä»…é€‚ç”¨äºç¨³æ€åˆ†æ</li>
                    <li><strong>é€‚ç”¨ï¼š</strong>æ­£å¼¦ç¨³æ€ç”µè·¯åˆ†æ</li>
                </ul>

                <div class="stats">
                    <div class="stat-item">
                        <span class="stat-value" id="phasorFreq">50</span>
                        <div class="stat-label">é¢‘ç‡ (Hz)</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="phasorMag">1.0</span>
                        <div class="stat-label">æ¨¡å€¼ (V)</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="phasorAngle">0</span>
                        <div class="stat-label">è§’åº¦ (Â°)</div>
                    </div>
                </div>
            </div>

            <!-- å¯¹æ¯”éƒ¨åˆ† -->
            <div class="comparison">
                <h2>ğŸ”„ ä¸¤ç§æ–¹æ³•çš„å…³ç³»ä¸è½¬æ¢</h2>
                
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <h3>ğŸ“Š æ•°å­¦åŸºç¡€</h3>
                        <p>æ—¶åŸŸæ³•ä½¿ç”¨å¾®ç§¯åˆ†ï¼Œç›¸é‡æ³•ä½¿ç”¨å¤æ•°è¿ç®—ï¼Œä¸¤è€…é€šè¿‡æ¬§æ‹‰å…¬å¼ e^(jÏ‰t) = cos(Ï‰t) + jsin(Ï‰t) å»ºç«‹è”ç³»</p>
                    </div>
                    <div class="comparison-item">
                        <h3>âš¡ è®¡ç®—å¤æ‚åº¦</h3>
                        <p>æ—¶åŸŸæ³•éœ€è§£å¾®åˆ†æ–¹ç¨‹ï¼Œè®¡ç®—å¤æ‚ï¼›ç›¸é‡æ³•è½¬æ¢ä¸ºä»£æ•°æ–¹ç¨‹ï¼Œå¤§å¤§ç®€åŒ–è®¡ç®—è¿‡ç¨‹</p>
                    </div>
                    <div class="comparison-item">
                        <h3>ğŸ¯ é€‚ç”¨èŒƒå›´</h3>
                        <p>æ—¶åŸŸæ³•é€‚ç”¨äºä»»ä½•ç”µè·¯ï¼›ç›¸é‡æ³•ä»…é€‚ç”¨äºçº¿æ€§ç”µè·¯çš„æ­£å¼¦ç¨³æ€åˆ†æ</p>
                    </div>
                    <div class="comparison-item">
                        <h3>ğŸ” ç‰©ç†æ„ä¹‰</h3>
                        <p>æ—¶åŸŸæ³•ç›´è§‚æ˜¾ç¤ºæ³¢å½¢ï¼›ç›¸é‡æ³•æŠ½è±¡ä½†ä¾¿äºåˆ†æå¹…åº¦å’Œç›¸ä½å…³ç³»</p>
                    </div>
                    <div class="comparison-item">
                        <h3>ğŸ“ˆ åˆ†æé‡ç‚¹</h3>
                        <p>æ—¶åŸŸæ³•å…³æ³¨ç¬æ€å“åº”ï¼›ç›¸é‡æ³•å…³æ³¨ç¨³æ€å“åº”å’Œé¢‘ç‡ç‰¹æ€§</p>
                    </div>
                    <div class="comparison-item">
                        <h3>ğŸ”„ è½¬æ¢å…³ç³»</h3>
                        <p>u(t) = Re{áºe^(jÏ‰t)}ï¼Œç¬æ—¶å€¼ç­‰äºç›¸é‡æ—‹è½¬ååœ¨å®è½´ä¸Šçš„æŠ•å½±</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ§åˆ¶é¢æ¿ -->
        <div class="control-panel">
            <h3>ğŸ® åŠ¨ç”»æ§åˆ¶é¢æ¿</h3>
            <div class="controls">
                <button class="btn-primary" onclick="startAnimation()">â–¶ï¸ æ’­æ”¾</button>
                <button class="btn-secondary" onclick="pauseAnimation()">â¸ï¸ æš‚åœ</button>
                <button class="btn-danger" onclick="resetAnimation()">â¹ï¸ é‡ç½®</button>
                <button class="btn-primary" onclick="changeFrequency()">ğŸ”„ æ”¹å˜é¢‘ç‡</button>
                <button class="btn-secondary" onclick="changePhase()">ğŸ”„ æ”¹å˜ç›¸ä½</button>
            </div>
        </div>

        <!-- å®æ—¶æ³¢å½¢å¯¹æ¯” -->
        <div class="section" style="margin: 20px;">
            <h2 class="section-title">ğŸ“Š å®æ—¶æ³¢å½¢å¯¹æ¯”</h2>
            <div class="animation-container">
                <canvas id="comparisonCanvas" width="800" height="300"></canvas>
            </div>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // å…¨å±€å˜é‡
        let animationId;
        let isAnimating = false;
        let time = 0;
        let frequency = 50;
        let amplitude = 1.0;
        let phase = 0;

        // è·å–ç”»å¸ƒä¸Šä¸‹æ–‡
        const timeCanvas = document.getElementById('timeDomainCanvas');
        const timeCtx = timeCanvas.getContext('2d');
        
        const phasorCanvas = document.getElementById('phasorCanvas');
        const phasorCtx = phasorCanvas.getContext('2d');
        
        const comparisonCanvas = document.getElementById('comparisonCanvas');
        const comparisonCtx = comparisonCanvas.getContext('2d');

        // è·å–å·¥å…·æç¤ºå…ƒç´ 
        const tooltip = document.getElementById('tooltip');

        // æ—¶åŸŸåŠ¨ç”»ç»˜åˆ¶å‡½æ•°
        function drawTimeDomain() {
            const width = timeCanvas.width;
            const height = timeCanvas.height;
            
            // æ¸…ç©ºç”»å¸ƒ
            timeCtx.clearRect(0, 0, width, height);
            
            // ç»˜åˆ¶èƒŒæ™¯ç½‘æ ¼
            timeCtx.strokeStyle = '#e2e8f0';
            timeCtx.lineWidth = 1;
            for (let i = 0; i <= 10; i++) {
                const x = (i / 10) * width;
                const y = (i / 10) * height;
                timeCtx.beginPath();
                timeCtx.moveTo(x, 0);
                timeCtx.lineTo(x, height);
                timeCtx.stroke();
                timeCtx.beginPath();
                timeCtx.moveTo(0, y);
                timeCtx.lineTo(width, y);
                timeCtx.stroke();
            }
            
            // ç»˜åˆ¶åæ ‡è½´
            timeCtx.strokeStyle = '#1e40af';
            timeCtx.lineWidth = 3;
            timeCtx.beginPath();
            timeCtx.moveTo(40, height / 2);
            timeCtx.lineTo(width - 20, height / 2);
            timeCtx.moveTo(40, 20);
            timeCtx.lineTo(40, height - 20);
            timeCtx.stroke();
            
            // ç»˜åˆ¶è½´æ ‡ç­¾
            timeCtx.fillStyle = '#1e293b';
            timeCtx.font = 'bold 14px Microsoft YaHei';
            timeCtx.fillText('t', width - 15, height / 2 + 20);
            timeCtx.fillText('u(t)', 25, 20);
            
            // ç»˜åˆ¶æ­£å¼¦æ³¢
            timeCtx.strokeStyle = '#0284c7';
            timeCtx.lineWidth = 4;
            timeCtx.beginPath();
            
            const omega = 2 * Math.PI * frequency;
            const points = [];
            
            for (let x = 0; x < width - 60; x++) {
                const t = (x / (width - 60)) * 0.04;
                const y = height / 2 - amplitude * 80 * Math.sin(omega * t + phase * Math.PI / 180);
                
                if (x === 0) {
                    timeCtx.moveTo(x + 40, y);
                } else {
                    timeCtx.lineTo(x + 40, y);
                }
                
                points.push({x: x + 40, y: y, t: t, value: Math.sin(omega * t + phase * Math.PI / 180)});
            }
            
            timeCtx.stroke();
            
            // ç»˜åˆ¶å½“å‰æ—¶é—´ç‚¹
            const currentX = 40 + (time % (width - 60));
            const currentY = height / 2 - amplitude * 80 * Math.sin(omega * time + phase * Math.PI / 180);
            
            timeCtx.fillStyle = '#dc2626';
            timeCtx.beginPath();
            timeCtx.arc(currentX, currentY, 8, 0, 2 * Math.PI);
            timeCtx.fill();
            
            // ç»˜åˆ¶å½“å‰å€¼
            timeCtx.fillStyle = '#1e293b';
            timeCtx.font = 'bold 16px Microsoft YaHei';
            const currentValue = Math.sin(omega * time + phase * Math.PI / 180).toFixed(3);
            timeCtx.fillText(`å½“å‰å€¼: ${currentValue}`, width - 140, 35);
            
            // é¼ æ ‡äº¤äº’
            timeCanvas.onmousemove = function(e) {
                const rect = timeCanvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                let closestPoint = null;
                let minDistance = Infinity;
                
                for (const point of points) {
                    const distance = Math.sqrt((x - point.x) ** 2 + (y - point.y) ** 2);
                    if (distance < minDistance && distance < 25) {
                        minDistance = distance;
                        closestPoint = point;
                    }
                }
                
                if (closestPoint) {
                    timeCanvas.style.cursor = 'pointer';
                    tooltip.innerHTML = `æ—¶é—´: ${(closestPoint.t * 1000).toFixed(1)}ms, å¹…å€¼: ${(closestPoint.value * amplitude).toFixed(3)}V`;
                    tooltip.style.left = e.clientX + 10 + 'px';
                    tooltip.style.top = e.clientY - 30 + 'px';
                    tooltip.classList.add('show');
                } else {
                    timeCanvas.style.cursor = 'default';
                    tooltip.classList.remove('show');
                }
            };
            
            timeCanvas.onmouseleave = function() {
                tooltip.classList.remove('show');
            };
        }

        // ç›¸é‡åŠ¨ç”»ç»˜åˆ¶å‡½æ•°
        function drawPhasor() {
            const width = phasorCanvas.width;
            const height = phasorCanvas.height;
            const centerX = width / 2;
            const centerY = height / 2;
            
            // æ¸…ç©ºç”»å¸ƒ
            phasorCtx.clearRect(0, 0, width, height);
            
            // ç»˜åˆ¶èƒŒæ™¯ç½‘æ ¼
            phasorCtx.strokeStyle = '#e2e8f0';
            phasorCtx.lineWidth = 1;
            for (let i = 0; i <= 10; i++) {
                const x = (i / 10) * width;
                const y = (i / 10) * height;
                phasorCtx.beginPath();
                phasorCtx.moveTo(x, 0);
                phasorCtx.lineTo(x, height);
                phasorCtx.stroke();
                phasorCtx.beginPath();
                phasorCtx.moveTo(0, y);
                phasorCtx.lineTo(width, y);
                phasorCtx.stroke();
            }
            
            // ç»˜åˆ¶åæ ‡è½´
            phasorCtx.strokeStyle = '#1e40af';
            phasorCtx.lineWidth = 3;
            phasorCtx.beginPath();
            phasorCtx.moveTo(centerX, 20);
            phasorCtx.lineTo(centerX, height - 20);
            phasorCtx.moveTo(20, centerY);
            phasorCtx.lineTo(width - 20, centerY);
            phasorCtx.stroke();
            
            // ç»˜åˆ¶è½´æ ‡ç­¾
            phasorCtx.fillStyle = '#1e293b';
            phasorCtx.font = 'bold 14px Microsoft YaHei';
            phasorCtx.fillText('Im', width - 15, centerY - 5);
            phasorCtx.fillText('Re', centerX + 5, 20);
            
            // ç»˜åˆ¶ç›¸é‡åœ†
            phasorCtx.strokeStyle = '#94a3b8';
            phasorCtx.lineWidth = 2;
            phasorCtx.beginPath();
            phasorCtx.arc(centerX, centerY, 100, 0, 2 * Math.PI);
            phasorCtx.stroke();
            
            // è®¡ç®—ç›¸é‡è§’åº¦
            const omega = 2 * Math.PI * frequency;
            const angle = omega * time + phase * Math.PI / 180;
            
            // ç»˜åˆ¶ç›¸é‡
            const phasorLength = amplitude * 100;
            const endX = centerX + phasorLength * Math.cos(angle);
            const endY = centerY - phasorLength * Math.sin(angle);
            
            phasorCtx.strokeStyle = '#dc2626';
            phasorCtx.lineWidth = 4;
            phasorCtx.beginPath();
            phasorCtx.moveTo(centerX, centerY);
            phasorCtx.lineTo(endX, endY);
            phasorCtx.stroke();
            
            // ç»˜åˆ¶ç›¸é‡ç«¯ç‚¹
            phasorCtx.fillStyle = '#dc2626';
            phasorCtx.beginPath();
            phasorCtx.arc(endX, endY, 8, 0, 2 * Math.PI);
            phasorCtx.fill();
            
            // ç»˜åˆ¶ç®­å¤´
            const arrowLength = 15;
            const arrowAngle = Math.PI / 6;
            
            phasorCtx.beginPath();
            phasorCtx.moveTo(endX, endY);
            phasorCtx.lineTo(
                endX - arrowLength * Math.cos(angle - arrowAngle),
                endY + arrowLength * Math.sin(angle - arrowAngle)
            );
            phasorCtx.moveTo(endX, endY);
            phasorCtx.lineTo(
                endX - arrowLength * Math.cos(angle + arrowAngle),
                endY + arrowLength * Math.sin(angle + arrowAngle)
            );
            phasorCtx.stroke();
            
            // ç»˜åˆ¶æŠ•å½±çº¿
            phasorCtx.strokeStyle = '#94a3b8';
            phasorCtx.lineWidth = 1;
            phasorCtx.setLineDash([5, 5]);
            
            phasorCtx.beginPath();
            phasorCtx.moveTo(endX, endY);
            phasorCtx.lineTo(endX, centerY);
            phasorCtx.stroke();
            
            phasorCtx.beginPath();
            phasorCtx.moveTo(endX, endY);
            phasorCtx.lineTo(centerX, endY);
            phasorCtx.stroke();
            
            phasorCtx.setLineDash([]);
            
            // ç»˜åˆ¶è§’åº¦æ ‡è®°
            phasorCtx.strokeStyle = '#dc2626';
            phasorCtx.lineWidth = 2;
            phasorCtx.beginPath();
            phasorCtx.arc(centerX, centerY, 40, -angle, 0);
            phasorCtx.stroke();
            
            // æ·»åŠ æ–‡å­—æ ‡ç­¾
            phasorCtx.fillStyle = '#1e293b';
            phasorCtx.font = 'bold 16px Microsoft YaHei';
            phasorCtx.fillText(`æ¨¡å€¼: ${amplitude.toFixed(2)}V`, 20, height - 50);
            phasorCtx.fillText(`è§’åº¦: ${(angle * 180 / Math.PI % 360).toFixed(1)}Â°`, 20, height - 30);
            
            phasorCtx.fillStyle = '#1e40af';
            phasorCtx.font = 'bold 16px Microsoft YaHei';
            phasorCtx.fillText(`áº = ${amplitude.toFixed(2)}âˆ ${(phase).toFixed(1)}Â°`, width - 150, height - 30);
            
            // é¼ æ ‡äº¤äº’
            phasorCanvas.onmousemove = function(e) {
                const rect = phasorCanvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const distance = Math.sqrt((x - endX) ** 2 + (y - endY) ** 2);
                
                if (distance < 25) {
                    phasorCanvas.style.cursor = 'pointer';
                    tooltip.innerHTML = `å®éƒ¨: ${(amplitude * Math.cos(angle)).toFixed(3)}V, è™šéƒ¨: ${(amplitude * Math.sin(angle)).toFixed(3)}V`;
                    tooltip.style.left = e.clientX + 10 + 'px';
                    tooltip.style.top = e.clientY - 30 + 'px';
                    tooltip.classList.add('show');
                } else {
                    phasorCanvas.style.cursor = 'default';
                    tooltip.classList.remove('show');
                }
            };
            
            phasorCanvas.onmouseleave = function() {
                tooltip.classList.remove('show');
            };
        }

        // å¯¹æ¯”å›¾ç»˜åˆ¶å‡½æ•°
        function drawComparison() {
            const width = comparisonCanvas.width;
            const height = comparisonCanvas.height;
            
            // æ¸…ç©ºç”»å¸ƒ
            comparisonCtx.clearRect(0, 0, width, height);
            
            // ç»˜åˆ¶èƒŒæ™¯
            comparisonCtx.fillStyle = '#f8fafc';
            comparisonCtx.fillRect(0, 0, width, height);
            
            // ç»˜åˆ¶ç½‘æ ¼
            comparisonCtx.strokeStyle = '#e2e8f0';
            comparisonCtx.lineWidth = 1;
            for (let i = 0; i <= 20; i++) {
                const x = (i / 20) * width;
                const y = (i / 20) * height;
                comparisonCtx.beginPath();
                comparisonCtx.moveTo(x, 0);
                comparisonCtx.lineTo(x, height);
                comparisonCtx.stroke();
                comparisonCtx.beginPath();
                comparisonCtx.moveTo(0, y);
                comparisonCtx.lineTo(width, y);
                comparisonCtx.stroke();
            }
            
            // ç»˜åˆ¶åæ ‡è½´
            comparisonCtx.strokeStyle = '#1e40af';
            comparisonCtx.lineWidth = 3;
            comparisonCtx.beginPath();
            comparisonCtx.moveTo(40, height / 2);
            comparisonCtx.lineTo(width - 20, height / 2);
            comparisonCtx.moveTo(40, 20);
            comparisonCtx.lineTo(40, height - 20);
            comparisonCtx.stroke();
            
            // ç»˜åˆ¶æ ‡ç­¾
            comparisonCtx.fillStyle = '#1e293b';
            comparisonCtx.font = 'bold 14px Microsoft YaHei';
            comparisonCtx.fillText('æ—¶é—´ (ms)', width - 100, height / 2 + 25);
            comparisonCtx.fillText('å¹…å€¼', 15, 30);
            comparisonCtx.fillText('æ—¶åŸŸæ³¢å½¢', width / 4, 45);
            comparisonCtx.fillText('ç›¸é‡æŠ•å½±', 3 * width / 4, 45);
            
            const omega = 2 * Math.PI * frequency;
            const points1 = [];
            const points2 = [];
            
            // ç»˜åˆ¶æ—¶åŸŸæ³¢å½¢
            comparisonCtx.strokeStyle = '#0284c7';
            comparisonCtx.lineWidth = 4;
            comparisonCtx.beginPath();
            
            for (let x = 0; x < width / 2 - 60; x++) {
                const t = (x / (width / 2 - 60)) * 0.08;
                const y = height / 4 - amplitude * 80 * Math.sin(omega * t + phase * Math.PI / 180);
                
                if (x === 0) {
                    comparisonCtx.moveTo(x + 40, y);
                } else {
                    comparisonCtx.lineTo(x + 40, y);
                }
                
                points1.push({x: x + 40, y: y, t: t, value: Math.sin(omega * t + phase * Math.PI / 180)});
            }
            
            comparisonCtx.stroke();
            
            // ç»˜åˆ¶ç›¸é‡æŠ•å½±
            comparisonCtx.strokeStyle = '#dc2626';
            comparisonCtx.lineWidth = 4;
            comparisonCtx.beginPath();
            
            for (let x = 0; x < width / 2 - 60; x++) {
                const t = (x / (width / 2 - 60)) * 0.08;
                const angle = omega * t + phase * Math.PI / 180;
                const y = 3 * height / 4 - amplitude * 80 * Math.cos(angle);
                
                if (x === 0) {
                    comparisonCtx.moveTo(x + width / 2 + 20, y);
                } else {
                    comparisonCtx.lineTo(x + width / 2 + 20, y);
                }
                
                points2.push({x: x + width / 2 + 20, y: y, t: t, value: Math.cos(omega * t + phase * Math.PI / 180)});
            }
            
            comparisonCtx.stroke();
            
            // ç»˜åˆ¶å½“å‰æ—¶é—´æ ‡è®°
            const currentX1 = 40 + (time % (width / 2 - 60));
            const currentY1 = height / 4 - amplitude * 80 * Math.sin(omega * time + phase * Math.PI / 180);
            
            comparisonCtx.fillStyle = '#0284c7';
            comparisonCtx.beginPath();
            comparisonCtx.arc(currentX1, currentY1, 8, 0, 2 * Math.PI);
            comparisonCtx.fill();
            
            const currentX2 = width / 2 + 20 + (time % (width / 2 - 60));
            const currentY2 = 3 * height / 4 - amplitude * 80 * Math.cos(omega * time + phase * Math.PI / 180);
            
            comparisonCtx.fillStyle = '#dc2626';
            comparisonCtx.beginPath();
            comparisonCtx.arc(currentX2, currentY2, 8, 0, 2 * Math.PI);
            comparisonCtx.fill();
            
            // é¼ æ ‡äº¤äº’
            comparisonCanvas.onmousemove = function(e) {
                const rect = comparisonCanvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                let closestPoint = null;
                let minDistance = Infinity;
                let chartType = '';
                
                for (const point of points1) {
                    const distance = Math.sqrt((x - point.x) ** 2 + (y - point.y) ** 2);
                    if (distance < minDistance && distance < 25) {
                        minDistance = distance;
                        closestPoint = point;
                        chartType = 'æ—¶åŸŸæ³¢å½¢';
                    }
                }
                
                for (const point of points2) {
                    const distance = Math.sqrt((x - point.x) ** 2 + (y - point.y) ** 2);
                    if (distance < minDistance && distance < 25) {
                        minDistance = distance;
                        closestPoint = point;
                        chartType = 'ç›¸é‡æŠ•å½±';
                    }
                }
                
                if (closestPoint) {
                    comparisonCanvas.style.cursor = 'pointer';
                    tooltip.innerHTML = `${chartType}<br>æ—¶é—´: ${(closestPoint.t * 1000).toFixed(1)}ms, å¹…å€¼: ${(closestPoint.value * amplitude).toFixed(3)}V`;
                    tooltip.style.left = e.clientX + 10 + 'px';
                    tooltip.style.top = e.clientY - 30 + 'px';
                    tooltip.classList.add('show');
                } else {
                    comparisonCanvas.style.cursor = 'default';
                    tooltip.classList.remove('show');
                }
            };
            
            comparisonCanvas.onmouseleave = function() {
                tooltip.classList.remove('show');
            };
        }

        // åŠ¨ç”»å¾ªç¯
        function animate() {
            if (!isAnimating) return;
            
            time += 0.001;
            if (time > 0.04) time = 0;
            
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            document.getElementById('timeFreq').textContent = frequency;
            document.getElementById('timeAmp').textContent = amplitude.toFixed(1);
            document.getElementById('timePhase').textContent = phase;
            
            document.getElementById('phasorFreq').textContent = frequency;
            document.getElementById('phasorMag').textContent = amplitude.toFixed(1);
            document.getElementById('phasorAngle').textContent = (phase + (2 * Math.PI * frequency * time * 180 / Math.PI) % 360).toFixed(0);
            
            drawTimeDomain();
            drawPhasor();
            drawComparison();
            
            animationId = requestAnimationFrame(animate);
        }

        // æ§åˆ¶å‡½æ•°
        function startAnimation() {
            if (!isAnimating) {
                isAnimating = true;
                animate();
            }
        }

        function pauseAnimation() {
            isAnimating = false;
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
        }

        function resetAnimation() {
            pauseAnimation();
            time = 0;
            drawTimeDomain();
            drawPhasor();
            drawComparison();
        }

        function changeFrequency() {
            frequency = frequency === 50 ? 100 : frequency === 100 ? 25 : 50;
            resetAnimation();
        }

        function changePhase() {
            phase = (phase + 45) % 360;
            resetAnimation();
        }

        // åˆå§‹åŒ–
        drawTimeDomain();
        drawPhasor();
        drawComparison();

        // è‡ªåŠ¨å¼€å§‹åŠ¨ç”»
        setTimeout(() => {
            startAnimation();
            isAnimating = true;
        }, 1000);

        // é”®ç›˜æ§åˆ¶
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case ' ':
                    e.preventDefault();
                    isAnimating ? pauseAnimation() : startAnimation();
                    break;
                case 'r':
                case 'R':
                    resetAnimation();
                    break;
                case 'f':
                case 'F':
                    changeFrequency();
                    break;
                case 'p':
                case 'P':
                    changePhase();
                    break;
            }
        });
    </script>
</body>
</html>